### 心理生理数据在玩家体验评价中的定量研究：通过机器学习在恐怖游戏中分类情绪的方法

#### ABSTRACT

传统问卷调查得到玩家体验分析的方法虽然可行但有很多缺点，本文提出一种分析方法，通过在完整游戏流程中进行生理数据收集，对游戏中标记时间内得到的多维生理数据进行机器学习，从而获得玩家特定情绪产生和消逝的时间点，进一步可量化出在风格化电子游戏内，玩家在参与游戏过程中的特定情绪体验是否达到游戏设计者的预期，且可以通过特定情绪体验在完整游戏流程内的时间占比，分析出玩家的特定情绪存在时长与游戏的可玩度直接的关系。最终利用此方法使游戏设计量化可控。从而提升游戏质量。

#### 1 介绍 INTRODUCTION

在游戏行业中，玩家在游戏中的体验对于游戏开发中期和后期的调整起着非常重要的作用。目前用户体验评估方法主要还是依靠访谈，问卷调查等形式[1]。但是这些方法不但有滞后性，同时会导致报告数据不准确。相反使用生理数据的客观性则可以实时反映玩家的体验情况[9]。同时在当下，利用机器学习的方法来让已有玩家调查问卷报告与其多种生理数据结合建模，可以客观化和自动化的模拟分析出玩家的游戏体验情况[2]。我们提出在连续的游戏进行的时间流程中，通过机器学习使玩家在校准阶段（intro阶段）用多个时间片内的生理数据和片段内的体验报告产生相关性，随后在正式的（regular阶段）游戏时长中，得到并用之前学习到的关系模型分析玩家的生理数据。判断玩家的情感变化情况是否是按照先前游戏设计人员安排好的节奏进行游戏。其中包含情感的触发时间和消逝时间点。在额外的一个工作当中，结合风格化电子游戏的情感变化节奏，定量分析出风格化产生的特定情绪是否可以影响玩家对游戏快乐度的体验。

#### 2 相关工作 RELATED WORK

- 2.1 风格化游戏

  虚拟现实设备现如今越来越成熟。当下以此设备为基础下的游戏应用对玩家体验的研究也有非常多。因为虚拟现实环境能够在用户中创造出有针对性的情绪，如快乐和恐惧。研究还发现，虚拟现实能够让人们对虚拟角色产生共鸣 [5]，相关的研究也有：

  - Rogers通过恐怖冒险游戏《Ethan Carter的消失》研究了VR中游戏音频感知对玩家体验的影响。
  - Wilson和McGill比较了用户在VR上玩恐怖视频游戏《生化危机7》的体验会在比电视上带来更高的presence。

  同时，不难发现这些研究都基于恐怖或惊悚类游戏，因为情感反应会在紧张和恐怖的游戏体验中产生非常强烈的影响[11]。

  我们在实验前期，进行过虚拟现实设备和通用显示器设备两种交互方式的尝试，因为在虚拟现实设备交互中，参与者会有幅度较大的自主运动，从而导致生理数据的不稳定和严重的噪声乃至错误，最终我们还是选择了传统显示器游戏的交互方式。同时在近期的探索性实验中Peng认为恐怖或惊悚类游戏在虚拟现实设备与传统显示器交互下相比提升的体验感并不是很多，而是带给玩家许多positive emotional experiences，会有更高等级的immersion and presence [7]

- 2.2 心理生理数据
  
  在心里生理学上，研究人员使用心理生理学反馈设备，如皮肤电导(SC)、心电图(ECG)等来检测用户在执行任务时的情感状态。其主要优点是信号可以被自动实时记录，而不会干扰参与者的自然行为。心理生理测量的另一个优点是它可以检测到非常敏感的反应，相关综述中更详细的进行了讨论[3]。
  
  - BVP、ECG和HR  [2] [3]
    - HR则用于测量情感、亲和力和注意力上的唤起（arousal in emotion，likeability，attention）；
    - BVP用于评估松弛（evaluating relaxation）；
    - BVP可以通过信号处理变换而得到HR [6]
  - GSR [3] [9]
    - 乐趣与GSR显著相关，皮肤电导已经被发现有一个线性变化的性质相对于情绪唤起。
    - 区分恐惧和生气（It has been used to classify different states such as anger and fear）
    
    BVP和GSR数据可以作为相关数据样本。过多的生理数据不但会影响数据分析，而且会让实验设备非常繁重。而单一的生理数据又有局限性，导致拟合关系程度偏低。
  
- 2.3 心理生理为数据的玩家体验

  - 通过脑电仪，胸带，指尖的GSR传感器获得的心理生理数据与与玩家的自我报告结合起来，从而创建一个基于机器学习的玩家享受模型。一个训练有素的模型可以让游戏开发者在不需要问卷调查的情况下获得关于玩家在特定游戏事件中的情绪的高质量数据[2]
  - 大多数受试者没有注意到视频质量的差异，这表明心理生理测量方法能够挖掘传统用户体验测量方法无法发现的潜在事实[3]（Most of the subjects didn’t notice the difference in video quality, which indicates that psychophysiological measure has the capability to mine the underlying fact that cannot be found using traditional methods of measuring user experience[124]）
  
  通过心理生理数据，无论是利用传统的信号统计分析，还是机器学习的方式，都可以获得对最终游戏的相关评价的回归关系，但是，对于在游戏完整流程中阶段性或者特殊性的分析，则并无提及。而本文，则是利用机器学习，在分析特殊阶段性内的生理数据，从而量化出生理数据与情绪评价和游戏体验的相关性。

#### 4 实验和建模 Experiments & Modeling

- 4.1系统环境 SYSTEM

  - 4.1.1所需硬件设备

    本次实验用到的硬件环境是HTC Vive VR系统，PC机为台式机，配置为NVIDIA RTX 2060，16G内存，AMD Ryzen3600，一副降噪耳机作为声音的输出设备。

    生理数据的检测和收集在实验之处有两个备选方案：一个是使用 E4 wristband 设备，另一个是利用相关传感器和单片机的自制设备，但是经过前期实验，我们发现自制设备是最优选择。

  - 4.1.2游戏类型

    实验用到的游戏是我们用Unity 开发的一款单人恐怖类型的游戏。相比于其他类型的游戏元素（如：愉悦感，幸福感），恐怖元素对于玩家的情感调动更为强烈，同时在实验过程中的生理数据能有显著的变化[11] [12]。在恐怖游戏中，通过精心设计的画面和声音，可以获得区分度足够高的玩家情绪反应，这些剧烈的情绪反应可以通过生理数据有效获取。

  - 4.1.3 生理数据采集和游戏内时间标记

    - 在相关工作中已经知道生理数据BVP和GSR数据反应的心理指标，在我们的方法中也需要此数据，（E4设备会将BVP的元数据去伪影，我们使用的自制设备需要后期的数据处理阶段来去噪）。同时连续BVP数据是可以通过采样得出HR等数据的，这两种数据是可以反应玩家的兴奋度，紧张度和专注度等情绪状态。
    - 游戏中的时间标记，是我们在开发游戏时由游戏设计人员给予的一个时间标记，即当玩家第一次进入特定区域后，或者视野中第一次看到某特定内容，从此时刻开始，是开发人员意图给玩家带来一个特定的情绪，在此处与生理数据的时间相对应。

- 4.2 参与者情况
  
  - 参与者的描述比例
  
    …………*TODO*…………
  
  - 是否有自身的生理或情绪的问题
    - 提前掌握参与者自述身体情况，例如是否是高血压，或者有潜在的心脏问题，这些是必要的，且也是参与者的隐私，研究人员和参与者会达成隐私保护的协议。
    - 实验前与其对话，保证参与游戏体验的人员在前一天得到了充分的休息，并且没有相关的情感问题的影响。
    - 提醒参与者，如果在实验当中对VR设备或者身体的不适，要通知我们研究人员。
    
  - 是否可以掌握VR设备
  
    - 研究人员在实验开始前，会让参与者熟悉VR设备。并且，熟悉和游戏内相关的VR的操作方式，但并不是在游戏中进行。
  
  - 是否抵触实验和游戏
  
    - 告诉参与者要如是回答和尽可能准确的回答游戏体验结束后的问卷。
    - 同时告诉参与者，所参与体验的游戏是具体的类型和操作方式，并提醒参与者要尽可能的完成整个游戏和解密，在游戏过程中，研究人员不再给予参与者提示。
  
- 4.3 数据收集
  
  - 游戏设计者给予的时间戳记录
    - 在游戏启动来到过场时，也是校准阶段，此阶段在其他学者的研究中，是单独的一个实验环节，用于生理反馈采集玩家平静和紧张生理数据，作为后续游戏中的反馈交互相关触发值[11] [12] [13]。我们也在此阶段前期的一段时间内对玩家进行一个平和情绪校准，紧接着通过一个突兀的声音和画面组成的jump scare，对玩家进行一个惊悚情绪的校准。此处的校准生理数值会在之后进行预处理后成为机器学习的样本库。同时我们将校准阶段和游戏阶段整合在同一个游戏中，是符合完整的游戏流程体验的。
    - 在开始后正式进行游戏时，设计者添加预计可以给玩家带来特定情绪的标签，例如：jump scare ，环境的诡异变化，或是面对敌人的威胁等，就会加一个“恐惧”的标签。当玩家在明亮的区域内，背景音乐安全舒缓，应加一个“正常”的标签。
  - 完整VR游戏流程中的生理数据BVP，GSR的记录
    - 测试期间的室内环境需要一个差不多干爽恒温的环境。
    - 光学传感器收集的BVP在手腕大幅运动时，会有信号的扭曲，同时GSR数据信号也有这个问题（hand placement is sometimes found to be inconvenient and the placement also distorts the signal when a person is moving）[3]，所以，我们需要玩家的左手（臂）上戴上腕表后，保持一个相对稳定的姿势。让玩家的右手手持控制器进行与VR游戏内元素的互动。
    - 我们为E4设备和Log System开发了一个独立的模块，可以进行后台的socket TCP client stream以及file stream的output，这样，我们不会影响前台游戏的进行。在数据方面，我们在生理设备以 `<STREAM_TYPE> <TIMESTAMP> <DATA>`  的格式来记录（参见E4 Data Package，其中时间戳是以1 January 1970, GMT 到数据的收集时间），而游戏内mark也以此格式来记录 `<MARK_TYPE> <TIMESTAMP> <DATA>` ，这样我们在后续数据预处理的时候会非常方便。(此处注意C#的时间戳是基准点为UTC 1601-1-1，所以需要进行转换)
  - ==体验后玩家调查问卷内容==
    
    - 问卷我们采用基于李斯特五量表的主观问卷（表1）和最终的自我评估模型(SAM)（1~9 scales）[10]，我们设计的反馈量表如下：
    
      |  ID  |                             问题                             | Very Weak | Weak | Normal | Strong | Very Strong |
      | :--: | :----------------------------------------------------------: | --------- | ---- | ------ | ------ | ----------- |
      |  1   |     Q1：在主菜单出来前的过场Intro中感觉被惊吓的程度如何?     |           |      |        |        |             |
      |  2   | Q2：在游戏正式开始后体验到恐惧的程度是如何的?（不包括之前的Intro） |           |      |        |        |             |
      |  3   |     Q3：在整个游戏中感受到恐惧感的变化的程度是怎么样的？     |           |      |        |        |             |
    |  4   |                Q4：很清楚游戏中的玩法机制么？                |           |      |        |        |             |
      |  5   |                    Q5：感觉到游戏好玩么？                    |           |      |        |        |             |
      
      SAM表（1~9）在完成游戏后，你当前的感觉是：
      
      （1表示最弱，9表示最强；以支配度为例，觉得自己具有支配能力“强大”“勇敢”等则趋向9，觉得自己被支配“弱小”“害怕”则趋于1）
      
      |                     | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    |
      | ------------------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
      | 愉悦度（arousal）   |      |      |      |      |      |      |      |      |      |
      | 兴奋度（valence）   |      |      |      |      |      |      |      |      |      |
      | 支配度（dominance） |      |      |      |      |      |      |      |      |      |
      
      
  
- 4.4 数据处理

  - 丢失数据的弥补
    - 对于生理数据采集，该设备的采集频率为64Hz，如果发生了某一时刻的数据丢失，我们会以此时刻的前后时刻数值的平均值  $v_{t1} = (v_{t0} + v_{t2}) * 0.5$，弥补成为丢失时刻的数据（传感设备和PC通过蓝牙近距离传输数据，几乎没有数据丢失）
  - 预处理数据
    - 校准数据的处理，校验数据分为2个部分。记录平静情绪时的生理数值7s，恐惧情绪时的生理数值7s。我们会以2s时间长度切分为一个特征的训练集（2秒内有128个特征数值），一段校准数据集的时间长度7s内，可以切分出5组数据集 $SetNum_c = T_c - T_s$ 。
    - 对于平静情绪，我们可以看作为是基准0值，恐惧情绪，我们可以看作为是变化值。激素反应是情绪反应三个成分之一，在应激反应下自主神经反应和激素反应处于分解代谢过程。而恐惧情绪是产生洽是因为外界刺激产生，属于应激状态下的一种[8]。那么在恐惧感产生后的时间段内，也会混杂进一些平静情绪的生理值，所以我们会在后期进行两次机器学习后，进行排除。

- 4.5 机器学习

  - 采用which方法，why？

    - …………*TODO*…………
  
  - 首先通过对恐惧情绪样本的训练，然后在完整游戏时长的数据中得到恐惧情绪的时间长度集合，然后我们通过标记法，将重叠的恐惧时长部分不被重复统计。这样会得到时间长度集 ，例如：
    $$
    L_{horror} = \{L_{(0,7)},L_{(10,23)}...L_{(n,m)}\}\\
    L_{(n,m)} = \{t_n,t_{n+1},...,t_m\}
    $$
    
  - 然后通过对平静情绪样本的训练，在完整游戏时长的数据中得到平静情绪的时间长度集合，同上一步，我们也会得到一个平静时间的长度集： $ L_{normal} = \{L_{(6,10)},L_{(19,30)}...L_{(n,m)}\}\\ $ ，接下来，我们进行一个相对补集，得到最终的恐惧时长 $L = L_{horror} - L_{normal}$
  
- 4.6 提出假设
  
  - 玩家的情绪体验是否可以按照游戏设计者既定的顺序被“控制”？
  - 对于风格化的游戏而言，风格化的情绪占比与玩家对游戏最终体验结果的关系是怎样的？

#### 5 结果和讨论 RESULTS & DISCUSSION

- 数据是什么，相关说明
  - 问卷调查的统计结果，ANOVA进行分析
    - SAM的最终的结果：…………*TODO*…………
    - 自定义问卷量表的结果：…………*TODO*…………
  - 游戏设计人员设计的时间点和实际游戏中参与人员体验数据的结果
    - …………*TODO*…………
  - 最终问卷结果和特殊情绪时长比例的关系
    - …………*TODO*…………
- 对于假设1和假设2，是否可以达到，为什么
  - 对于假设1：…………*TODO*…………
  - 对于假设2：…………*TODO*…………

- 谈谈参与人员的相关问题
  - …………*TODO*…………
- 谈谈游戏生理数据收集时候的问题
  - 对于校准阶段，对于时间片段集的切分选用的2sec的长度值，我们是只是经过测试而发现，这样的时间可以更有利于机器学习样本集的划分，使其更好的进行学习。
  - 本文所使用的自制收集玩家生理数据的设备，由于客观存在的问题，无法有效获得稳定数据。在将来工作中，我们期待测量硬件可以更加成熟和便捷，使得本文提出的模型，可以获得精度更高的参数。
- 谈谈用户问卷时候的问题
  - 对于游戏故事架构上给人带来的心理思考后的恐惧（细思极恐），不是本文的调研范围。

#### 7  CONCLUSION & FUTURE WORK

本文提出了一种使用机器学习，对玩家生理数据、游戏数据以及心理调查问卷评分进行建模的方法。通过该模型，可以有效获得特定情绪持续时长信息。为了验证本方法的有效性，我们开发了一个恐怖游戏的Demo，通过实验手段进行了验证。从实验数据的分析结果来看，本文方法能够，在完整的游戏流程体验周期中，对XX个体验者进行生理数据的收集和体验结束后的调查问卷。我们想通过这样一个方式方法应用到更为通用的游戏当中，因为在游戏开发中后期，调整游戏情节的情感带动，验证游戏设计者的设计目的，是非常重要且有意义的。

接下来通过机器学习对完整游戏流中事先设定好的校准阶段是数据样本进行学习，然后在后续连续时间内的对情感体验分类，我们可以看出……TODO……，对于非入侵样式的设备采集到的生理数据样本，BVP和GSR已经可以客观的表现出参与者在游戏体验中的……TODO……。这样从游戏设计者的视角中，可以定量的分析出……TODO……。与此同时，我们还可以得知，再某些特定的游戏中，情感的持续时间的占比和游戏的体验度的关系是……TODO……。

将来可以通过本文的研究思路和方法，应用在其他游戏中进行验证，从而得到更为通用的数据模型。然后我们可通更多维度的生理数据的测量收集，量化分析哪些相关的生理数据维度，可以用来更加精准的分类玩家的心理活动情感变化。最后，因为玩家的情绪是可以影响其在游戏中的表现，那么通过记录游戏内数据，使其与生理结果通过机器学习产生相关性建模，进行更进一步的实验，这样优势在于从更易得的游戏数据中得到生理数据的推测和最终游戏体验值会更加容易。

#### References

1. Game User Experience Evaluation; Springer: Berlin/Heidelberg, Germany, 2015.
2. Psychophysiological Indicators for Modeling User Experience in Interactive Digital Entertainment. 2019, 19(5):989.
3. A Survey on Psycho-Physiological Analysis & Measurement Methods in Multimodal Systems. 2019, 3(2)
4. Effects of voluntary heart rate control on user engagement and agency in a virtual reality game. 2020, :1-17.
5. Effects of Manipulating Physiological Feedback in Immersive Virtual Environments. 2018, :101-111.
6. Emotional State and Cognitive Load Analysis using Features from BVP
7. Beyond Horror and Fear: Exploring Player Experience Invoked by Emotional Challenge in VR Games
8. Foundations of Behavioral Neuroscience 
9. A review of the use of psychophysiological methods in game research
10. Margaret M Bradley and Peter J Lang. 1994. Measuring emotion: the self-assessment manikin and the semantic differential. Journal of behavior therapy and experimental psychiatry 25, 1 (1994), 49–59
11. Vanishing scares biofeedback modulation of affective player experiences in a procedural horror game
12. Please Biofeed the Zombies: Enhancing the Gameplay and Display of a Horror Game Using Biofeedback
13. Fear as a Biofeedback Game Mechanic in Virtual Reality: Effects on Engagement and Perceived Usability

